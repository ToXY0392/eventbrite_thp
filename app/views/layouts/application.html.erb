<!DOCTYPE html>
<html lang="fr" data-bs-theme="dark">
<head>
  <title><%= content_for?(:title) ? yield(:title) : t("app.title") %></title>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <%= csrf_meta_tags %>
  <%= csp_meta_tag %>

  <!-- PWA -->
  <%= tag.link rel: "manifest", href: pwa_manifest_path(format: :json) %>

  <!-- CSS : Bootstrap + Modern Business puis application (charg√©e en dernier pour overrides th√®me sombre) -->
  <%= stylesheet_link_tag "stylesheets/bootstrap", "data-turbo-track": "reload" %>
  <%= stylesheet_link_tag "stylesheets/modern-business", "data-turbo-track": "reload" %>
  <%= stylesheet_link_tag "application", "data-turbo-track": "reload" %>
</head>

<body class="d-flex flex-column">
  <header>
  <nav class="navbar navbar-expand-lg navbar-dark bg-dark navbar-eventbrite sticky-top">
    <div class="container">
      <%= link_to root_path, class: "navbar-brand d-flex align-items-center" do %>
        <span class="brand-logo">EB</span>
        <span class="brand-text ms-2">EventbriteTHP</span>
      <% end %>

      <button class="navbar-toggler border-0" type="button" data-bs-toggle="collapse" data-bs-target="#navbarMain">
        <span class="navbar-toggler-icon"></span>
      </button>

      <div class="collapse navbar-collapse" id="navbarMain">
        <ul class="navbar-nav me-auto">
          <li class="nav-item">
            <%= link_to t("app.nav.home"), root_path, class: "nav-link px-3" %>
          </li>
        </ul>

        <ul class="navbar-nav align-items-center gap-2">
          <% if user_signed_in? %>
            <li class="nav-item">
              <%= link_to new_event_path, class: "btn btn-primary btn-sm px-3" do %>
                <span class="d-none d-md-inline"><%= t("app.nav.create_event") %></span>
                <span class="d-md-none">+</span>
              <% end %>
            </li>
            <li class="nav-item dropdown">
              <a class="nav-link dropdown-toggle d-flex align-items-center py-2" href="#" data-bs-toggle="dropdown">
                <%= image_tag current_user.avatar_or_default, class: "rounded-circle me-2", style: "width: 32px; height: 32px; object-fit: cover;" %>
                <span class="d-none d-lg-inline"><%= current_user.first_name.presence || t("app.nav.profile") %></span>
              </a>
              <ul class="dropdown-menu dropdown-menu-end shadow border-0">
                <li><%= link_to user_path(current_user), class: "dropdown-item py-2" do %>
                  <span class="d-inline-block me-2">üë§</span><%= t("app.nav.profile") %>
                <% end %></li>
                <li><%= link_to edit_user_registration_path, class: "dropdown-item py-2" do %>
                  <span class="d-inline-block me-2">‚öôÔ∏è</span><%= t("app.nav.edit_account") %>
                <% end %></li>
                <li><hr class="dropdown-divider"></li>
                <li>
                  <%= button_to t("app.nav.sign_out"), destroy_user_session_path, method: :delete, class: "dropdown-item py-2 text-danger border-0 bg-transparent w-100 text-start" %>
                </li>
              </ul>
            </li>
          <% else %>
            <li class="nav-item">
              <%= link_to t("app.nav.sign_in"), new_user_session_path, class: "nav-link px-3" %>
            </li>
            <li class="nav-item">
              <%= link_to t("app.nav.sign_up"), new_user_registration_path, class: "btn btn-primary btn-sm px-3" %>
            </li>
          <% end %>
        </ul>
      </div>
    </div>
  </nav>
  </header>

  <main class="flex-grow-1">
    <% if notice || alert %>
      <div class="container py-2">
        <% if notice %>
          <div class="alert alert-success alert-dismissible fade show mb-0" role="alert">
            <%= notice %>
            <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
          </div>
        <% end %>
        <% if alert %>
          <div class="alert alert-danger alert-dismissible fade show mb-0" role="alert">
            <%= alert %>
            <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
          </div>
        <% end %>
      </div>
    <% end %>

    <% if content_for?(:skip_container) %>
      <%= yield %>
    <% else %>
      <div class="container py-5">
        <%= yield %>
      </div>
    <% end %>
  </main>

  <footer class="footer-eventbrite mt-auto">
    <div class="container footer-inner py-4">
      <div class="footer-content d-flex flex-column align-items-center text-center gap-3">
        <div class="d-flex align-items-center justify-content-center gap-4 flex-wrap">
          <%= link_to t("app.nav.home"), root_path, class: "footer-link" %>
          <%= link_to "https://www.thehackingproject.org", target: "_blank", rel: "noopener noreferrer", class: "footer-social-link", title: "The Hacking Project" do %>
            <svg class="footer-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true"><path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-1 17.93c-3.95-.49-7-3.85-7-7.93 0-.62.08-1.21.21-1.79L9 15v1c0 1.1.9 2 2 2v1.93zm6.9-2.54c-.26-.81-1-1.39-1.9-1.39h-1v-3c0-.55-.45-1-1-1H8v-2h2c.55 0 1-.45 1-1V7h2c1.1 0 2-.9 2-2v-.41c2.93 1.19 5 4.06 5 7.41 0 2.08-.8 3.97-2.1 5.39z"/></svg>
          <% end %>
          <%= link_to "https://www.linkedin.com/company/the-hacking-project", target: "_blank", rel: "noopener noreferrer", class: "footer-social-link", title: "LinkedIn" do %>
            <svg class="footer-icon" role="img" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" fill="currentColor" aria-hidden="true"><path d="M20.447 20.452h-3.554v-5.569c0-1.328-.027-3.037-1.852-3.037-1.853 0-2.136 1.445-2.136 2.939v5.667H9.351V9h3.414v1.561h.046c.477-.9 1.637-1.85 3.37-1.85 3.601 0 4.267 2.37 4.267 5.455v6.286zM5.337 7.433c-1.144 0-2.063-.926-2.063-2.065 0-1.138.92-2.063 2.063-2.063 1.14 0 2.064.925 2.064 2.063 0 1.139-.925 2.065-2.064 2.065zm1.782 13.019H3.555V9h3.564v11.452zM22.225 0H1.771C.792 0 0 .774 0 1.729v20.542C0 23.227.792 24 1.771 24h20.451C23.2 24 24 23.227 24 22.271V1.729C24 .774 23.2 0 22.222 0h.003z"/></svg>
          <% end %>
          <%= link_to "https://www.instagram.com/thehackingproject", target: "_blank", rel: "noopener noreferrer", class: "footer-social-link", title: "Instagram" do %>
            <svg class="footer-icon" role="img" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" fill="currentColor" aria-hidden="true"><path d="M12 0C8.74 0 8.333.015 7.053.072 5.775.132 4.905.333 4.14.63c-.789.306-1.459.717-2.126 1.384S.935 3.35.63 4.14C.333 4.905.131 5.775.072 7.053.012 8.333 0 8.74 0 12s.015 3.667.072 4.947c.06 1.277.261 2.148.558 2.913.306.788.717 1.459 1.384 2.126.667.666 1.336 1.079 2.126 1.384.766.296 1.636.499 2.913.558C8.333 23.988 8.74 24 12 24s3.667-.015 4.947-.072c1.277-.06 2.148-.262 2.913-.558.788-.306 1.459-.718 2.126-1.384.666-.667 1.079-1.335 1.384-2.126.296-.765.499-1.636.558-2.913.06-1.28.072-1.687.072-4.947s-.015-3.667-.072-4.947c-.06-1.277-.262-2.149-.558-2.913-.306-.789-.718-1.459-1.384-2.126C21.319 1.347 20.651.935 19.86.63c-.765-.297-1.636-.499-2.913-.558C15.667.012 15.26 0 12 0zm0 2.16c3.203 0 3.585.016 4.85.071 1.17.055 1.805.249 2.227.415.562.217.96.477 1.382.896.419.42.679.819.896 1.381.164.422.36 1.057.413 2.227.057 1.266.07 1.646.07 4.85s-.015 3.585-.074 4.85c-.061 1.17-.256 1.805-.421 2.227-.224.562-.479.96-.899 1.382-.419.419-.824.679-1.38.896-.42.164-1.065.36-2.235.413-1.274.057-1.649.07-4.859.07-3.211 0-3.586-.015-4.859-.074-1.171-.061-1.816-.256-2.236-.421-.569-.224-.96-.7-1.381-1.19-.42-.479-.674-.959-.899-1.381-.165-.42-.359-1.065-.42-2.235-.045-1.26-.061-1.649-.061-4.844 0-3.196.016-3.586.061-4.861.061-1.17.255-1.814.42-2.234.21-.57.479-.96.9-1.381.419-.419.81-.689 1.379-.898.42-.166 1.051-.361 2.221-.421 1.275-.045 1.65-.06 4.859-.06l.045.03zm0 5.838c-3.403 0-6.162 2.759-6.162 6.162S8.597 20.163 12 20.163s6.162-2.759 6.162-6.163c0-3.403-2.759-6.162-6.162-6.162zM12 16c-2.21 0-4-1.79-4-4s1.79-4 4-4 4 1.79 4 4-1.79 4-4 4zm7.846-10.405c0 .795-.646 1.44-1.44 1.44-.795 0-1.44-.646-1.44-1.44 0-.794.646-1.439 1.44-1.439.793-.001 1.44.645 1.44 1.439z"/></svg>
          <% end %>
        </div>
        <div class="footer-info small">
          <p class="text-white-50 mb-0"><%= t("app.footer.thp_project", default: "Projet r√©alis√© dans le cadre de The Hacking Project") %> ‚Ä¢ ¬© <%= Date.current.year %> EventbriteTHP ‚Ä¢ <%= t("app.footer.rights") %></p>
        </div>
      </div>
    </div>
  </footer>

  <!-- JS Rails + jQuery + Bootstrap (Propshaft : chemin depuis vendor/assets, ordre THP : jQuery ‚Üí Bootstrap) -->
  <%= javascript_importmap_tags %>
  <%= javascript_include_tag "javascripts/jquery.min", "data-turbo-track": "reload" %>
  <%= javascript_include_tag "javascripts/bootstrap.bundle", "data-turbo-track": "reload" %>
</body>
</html>